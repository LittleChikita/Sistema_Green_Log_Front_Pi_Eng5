<p-toast></p-toast>

<div>

  <div>
    <p-toolbar class="mb-6">
      <ng-template #start>
        <p-button class="mr-2" label="New" icon="pi pi-plus" (onClick)="openNovo()"></p-button>
        <p-button severity="danger" label="Delete" icon="pi pi-trash" outlined
                  (onClick)="deletarUsuario(usuarioSelecionado)"
                  [disabled]="!usuarioSelecionado" />
      </ng-template>
    </p-toolbar>

    <div class="mb-4">
      <label>Filtrar por primeira letra:</label>
      <select [(ngModel)]="letraSelecionada" (ngModelChange)="filtrarPorLetra($event)">
        <option value="">Todos</option>
        <option *ngFor="let letra of letras" [value]="letra">
          {{ letra }}
        </option>
      </select>
    </div>

    <p-table
      #dt
      [value]="usuariosFiltrados"
      [paginator]="true"
      [rows]="5"
      [rowsPerPageOptions]="[5, 10, 20]"
      selectionMode="single"
      [(selection)]="usuarioSelecionado"
      dataKey="id"
      [tableStyle]="{ 'min-width': '75rem' }">

      <ng-template pTemplate="header">
        <tr>
          <th>Nome</th>
          <th>Email</th>
          <th>Ações</th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-usuario>
        <tr [pSelectableRow]="usuario">
          <td>{{ usuario.nome }}</td>
          <td>{{ usuario.email }}</td>
          <td>
            <p-button icon="pi pi-pencil" class="mr-2" [rounded]="true" [outlined]="true"
                      (click)="editarUsuario(usuario)">
            </p-button>
          </td>
        </tr>
      </ng-template>

    </p-table>
  </div>

  <div>
    <p-dialog [(visible)]="usuarioDialog" [style]="{width: '450px'}"
              header="Usuário - Informações" [modal]="true"  [focusOnShow]="false">
      <ng-template pTemplate="content">
        <div class="flex flex-col gap-6">
          <div>
            <label for="nome" class="block font-bold mb-3">Nome</label>
            <input type="text" pInputText id="nome"
                   [(ngModel)]="usuarioForm.nome" required fluid />
            <small class="text-red-500" *ngIf="enviado && !usuarioForm.nome">
              Nome é obrigatório.
            </small>
          </div>

          <div>
            <label for="email" class="block font-bold mb-3">Email</label>
            <input type="text" pInputText id="email"
                   [(ngModel)]="usuarioForm.email" required fluid />
            <small class="text-red-500" *ngIf="enviado && !usuarioForm.email">
              Email é obrigatório.
            </small>
          </div>

          <div>
            <label class="block font-bold mb-3">Senha</label>
            <p-password id="senha"
                        [(ngModel)]="usuarioForm.senha"
                        placeholder="Digite a Senha"
                        [toggleMask]="true"
                        [feedback]="false">
            </p-password>
          </div>
        </div>
      </ng-template>

      <ng-template pTemplate="footer">
        <p-button label="Cancelar" icon="pi pi-times" text (click)="fecharDialog()" />
        <p-button label="Salvar" icon="pi pi-check" (click)="salvar()" />
      </ng-template>
    </p-dialog>

    <p-confirmDialog [style]="{ width: '450px' }" />
  </div>

</div>
